/*!
 * vue-lazy v1.0.1
 * (c) 2019 Nuno Balbona
 * Released under the MIT License.
 */

!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports):"function"==typeof define&&define.amd?define(["exports"],n):n(e.VueLazy=e.VueLazy||{})}(this,function(e){"use strict";var n=function(){if("IntersectionObserver"in window&&"IntersectionObserverEntry"in window&&"intersectionRect"in window.IntersectionObserverEntry.prototype)return"isIntersecting"in window.IntersectionObserverEntry.prototype||Object.defineProperty(window.IntersectionObserverEntry.prototype,"isIntersecting",{get:function(){return 0<this.intersectionRect.width||0<this.intersectionRect.height}}),!0;return!1}();var r="undefined"!=typeof window,i=function(e,n){return"undefined"!=typeof getComputedStyle?getComputedStyle(e,null).getPropertyValue(n):e.style[n]};function o(e){if(r){if(!(e instanceof HTMLElement))return window;for(var n,t=e;t&&t!==document.body&&t!==document.documentElement&&t.parentNode;){if(/(scroll|auto)/.test(i(n=t,"overflow")+i(n,"overflow-y")+i(n,"overflow-x")))return t;t=t.parentNode}return window}}var t=!!n&&new IntersectionObserver(function(e,n){e.forEach(function(e){e.isIntersecting&&m(e.target)})});var u=Object.freeze({observe:function(e){t.observe(e.el)},unobserve:function(e){t.unobserve(e.el)}});function c(){var r=[],i=[];this.get=function(e){var n=r.indexOf(e);return-1===n?null:i[n]},this.has=function(e){return-1!==r.indexOf(e)},this.set=function(e,n){var t=r.indexOf(e);-1===t?(r.push(e),i.push(n)):(r[t]=e,i[t]=n)},this.delete=function(e){var n=r.indexOf(e);if(-1===n)return!1;r.splice(n,1),i.splice(n,1)}}var s=1.3,d=["scroll","wheel","mousewheel","resize","animationend","transitionend","touchmove"],a=new c;function v(e){a.get(e).filter(function(e){return(n=e.getBoundingClientRect()).top<window.innerHeight*s&&0<n.bottom&&n.left<window.innerWidth*s&&0<n.right;var n}).forEach(function(e){m(e)})}function f(i,e){if(!a.has(i)){var o=[];o.eventFired=(u=v.bind(this,i),c=200,s=null,f=0,function(){if(!s){var e=Date.now()-f,n=this,t=arguments,r=function(){f=Date.now(),s=!1,u.apply(n,t)};c<=e?r():s=setTimeout(r,c)}}),a.set(i,o),d.forEach(function(e){return n=i,t=e,r=o.eventFired,void n.addEventListener(t,r,{passive:!0});var n,t,r})}var u,c,s,f,n=a.get(i);n.push(e),a.set(i,n)}var l=Object.freeze({observe:function(e){var t=e.el;e.binding,e.vnode;setTimeout(function(){var e=[o(t)];e[0]!==window&&e.push(window),e.forEach(function(n){f(n,t),setTimeout(function(){var e=a.get(n);e&&e.eventFired()})})},10)},unobserve:function(e){var n=e.el,t=(e.binding,e.vnode,[o(n)]);t[0]!==window&&t.push(window),t.forEach(function(e){!function(i,e){var o=a.get(i);if(o){var n=o.indexOf(e);-1!==n&&(o.splice(n,1),0<o.length?a.set(i,o):(d.forEach(function(e){return n=i,t=e,r=o.eventFired,void n.removeEventListener(t,r);var n,t,r}),a.delete(i)))}}(e,n)})}}),w=n?u:l,p=w.observe,h=w.unobserve,b=new c,g={install:function(e,n){void 0===n&&(n={}),e.directive("lazy",{bind:y,update:y,componentUpdated:y,unbind:A})}};function A(e,n,t){var r=b.get(e);b.delete(e),h(r)}function y(e,n,t){var r={el:e,vnode:t,binding:n,src:null};O(r),b.set(e,r),r.src=n.value,p(r)}function m(e){var n,t,r,i,o=b.get(e);if(!o)return console.warn("[vue-lazy] Image had no data: "+e),!1;h(o),n=o.src,t=function(e){var n=e.src;o.src=n,O(o)},r=function(e){o.src=e.src,O(o)},(i=new Image).src=n,i.onload=function(){t({src:i.src})},i.onerror=function(e){r(e)}}function O(e){var n=e.el,t=e.src,r=e.binding;if(!n)return!1;t||(t="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"),r.arg?n.style[r.arg]='url("'+t+'")':n.getAttribute("src")!==t&&n.setAttribute("src",t)}var E=Object.freeze({default:g,componentAppeared:m}),I=E&&g||E;e.default=I,Object.defineProperty(e,"__esModule",{value:!0})});