/*!
 * vue-lazy v1.0.2
 * (c) 2019 Nuno Balbona
 * Released under the MIT License.
 */

!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports):"function"==typeof define&&define.amd?define(["exports"],n):n(e.VueLazy=e.VueLazy||{})}(this,function(e){"use strict";var n=function(){if("IntersectionObserver"in window&&"IntersectionObserverEntry"in window&&"intersectionRect"in window.IntersectionObserverEntry.prototype)return"isIntersecting"in window.IntersectionObserverEntry.prototype||Object.defineProperty(window.IntersectionObserverEntry.prototype,"isIntersecting",{get:function(){return 0<this.intersectionRect.width||0<this.intersectionRect.height}}),!0;return!1}();var r="undefined"!=typeof window,i=function(e,n){return"undefined"!=typeof getComputedStyle?getComputedStyle(e,null).getPropertyValue(n):e.style[n]};function o(e){if(r){if(!(e instanceof HTMLElement))return window;for(var n,t=e;t&&t!==document.body&&t!==document.documentElement&&t.parentNode;){if(/(scroll|auto)/.test(i(n=t,"overflow")+i(n,"overflow-y")+i(n,"overflow-x")))return t;t=t.parentNode}return window}}function t(){if("Map"in window)return new Map;var r=[],i=[];return this.get=function(e){var n=r.indexOf(e);return-1===n?null:i[n]},this.has=function(e){return-1!==r.indexOf(e)},this.set=function(e,n){var t=r.indexOf(e);-1===t?(r.push(e),i.push(n)):(r[t]=e,i[t]=n)},this.delete=function(e){var n=r.indexOf(e);if(-1===n)return!1;r.splice(n,1),i.splice(n,1)},this}var u=!!n&&new IntersectionObserver(function(e,n){e.forEach(function(e){e.isIntersecting&&s.get(e.target)()})}),s=new t;var c=Object.freeze({observe:function(e,n){s.set(e,n),u.observe(e)},unobserve:function(e){s.delete(e),u.unobserve(e)}}),f=1.3,d=["scroll","wheel","mousewheel","resize","animationend","transitionend","touchmove"],a=new t,v=new t;function l(e){a.get(e).filter(function(e){return(n=e.getBoundingClientRect()).top<window.innerHeight*f&&0<n.bottom&&n.left<window.innerWidth*f&&0<n.right;var n}).forEach(function(e){v.get(e)()})}function p(i,e){if(!a.has(i)){var o=[];o.eventFired=(u=l.bind(this,i),s=200,c=null,f=0,function(){if(!c){var e=Date.now()-f,n=this,t=arguments,r=function(){f=Date.now(),c=!1,u.apply(n,t)};s<=e?r():c=setTimeout(r,s)}}),a.set(i,o),d.forEach(function(e){return n=i,t=e,r=o.eventFired,void n.addEventListener(t,r,{passive:!0});var n,t,r})}var u,s,c,f,n=a.get(i);n.push(e),a.set(i,n)}var w=Object.freeze({observe:function(t,e){v.set(t,e),setTimeout(function(){var e=[o(t)];e[0]!==window&&e.push(window),e.forEach(function(n){p(n,t),setTimeout(function(){var e=a.get(n);e&&e.eventFired()})})},10)},unobserve:function(n){v.delete(n);var e=[o(n)];e[0]!==window&&e.push(window),e.forEach(function(e){!function(i,e){var o=a.get(i);if(o){var n=o.indexOf(e);-1!==n&&(o.splice(n,1),0<o.length?a.set(i,o):(d.forEach(function(e){return n=i,t=e,r=o.eventFired,void n.removeEventListener(t,r);var n,t,r}),a.delete(i)))}}(e,n)})}}),h=n?c:w;function b(){h.unobserve.apply(h,arguments)}var y=new t;function A(e,n,t){y.delete(e),b(e)}function g(e,n,t){var r={bindType:n.arg,src:null};m(e,r),r.src=n.value,y.set(e,r),function(){h.observe.apply(h,arguments)}(e,function(){!function(t){var r=y.get(t);if(!r)return console.warn("[vue-lazy] Image had no data: "+t);b(t),e=r.src,n=function(e){var n=e.src;r.src=n,m(t,r)},i=function(e){r.src=e.src,m(t,r)},o=new Image,o.src=e,o.onload=function(){n({src:o.src})},o.onerror=function(e){i(e)};var e,n,i,o}(e)})}function m(e,n){if(!e)return!1;var t=n.src||"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7";n.bindType?e.style[n.bindType]='url("'+t+'")':e.getAttribute("src")!==t&&e.setAttribute("src",t)}var O={install:function(e,n){void 0===n&&(n={}),void 0===n.preferedObserver&&(n.preferedObserver=!1),n.preferedObserver&&function(e){if("custom"===e)h=w;else{if("intersection"!==e)throw new Error("[vue-lazy] Unknown observer name");h=c}}(n.preferedObserver),e.directive("lazy",{bind:g,update:g,componentUpdated:g,unbind:A})}};e.default=O,Object.defineProperty(e,"__esModule",{value:!0})});